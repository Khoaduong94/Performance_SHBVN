<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tool T√≠nh % ƒê·∫°t ƒê∆∞·ª£c Theo Level (New Logic)</title>
  <style>
    /* --- GI·ªÆ NGUY√äN GIAO DI·ªÜN GLASSMORPHISM C≈® --- */
    body {
      font-family: "Poppins", Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      backdrop-filter: blur(10px);
    }

    .container {
      background: rgba(255, 255, 255, 0.15);
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      width: 350px;
      padding: 30px;
      text-align: center;
      color: #fff;
    }

    h2 { margin-bottom: 15px; font-weight: 600; text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2); }
    label { font-size: 15px; display: block; margin-top: 10px; text-align: left; opacity: 0.9; }
    
    select, input {
      width: 100%; padding: 10px; margin-top: 5px; border: none; border-radius: 10px;
      background: rgba(255, 255, 255, 0.25); color: #fff; font-size: 15px; outline: none;
      transition: background 0.3s ease; box-sizing: border-box; /* Fix l·ªói padding l√†m tr√†n khung */
    }
    select:focus, input:focus { background: rgba(255, 255, 255, 0.4); }
    option { color: #000; }

    .btn-group { display: flex; justify-content: space-between; margin-top: 15px; }
    button {
      width: 48%; padding: 10px 15px; font-size: 16px; border: none; border-radius: 10px;
      cursor: pointer; transition: all 0.3s ease;
    }
    #submitBtn { background: rgba(76, 175, 80, 0.7); color: #fff; }
    #submitBtn:hover { background: rgba(76, 175, 80, 1); }
    #resetBtn { background: rgba(255, 255, 255, 0.25); color: #fff; }
    #resetBtn:hover { background: rgba(255, 255, 255, 0.4); }

    .progress-container {
      width: 100%; background: rgba(255, 255, 255, 0.2); border-radius: 20px;
      margin-top: 20px; height: 25px; overflow: hidden;
    }
    .progress-bar {
      height: 100%; width: 0%; background: linear-gradient(90deg, #ffb347, #ffcc33);
      text-align: center; line-height: 25px; color: white; font-weight: bold;
      border-radius: 20px; transition: width 0.6s ease;
    }
    p { font-size: 16px; margin-top: 20px; line-height: 1.6; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
    
    /* Highlight s·ªë li·ªáu quan tr·ªçng */
    strong { color: #fff; }
  </style>
</head>
<body>

  <div class="container">
    <h2>üéØ KPI</h2>

    <label for="level">Ch·ªçn Level:</label>
    <select id="level">
      <option value="SO">SO (Target: 2 CC / 380 PL)</option>
      <option value="SSO">SSO (Target: 3 CC / 520 PL)</option>
      <option value="SE">SE (Target: 4 CC / 700 PL)</option>
    </select>

    <label for="CC">Nh·∫≠p CC (T·ª∑ l·ªá 20%):</label>
    <input type="number" id="CC" placeholder="Nh·∫≠p s·ªë CC th·ª±c ƒë·∫°t">

    <label for="PL">Nh·∫≠p PL (T·ª∑ l·ªá 80%):</label>
    <input type="number" id="PL" placeholder="Nh·∫≠p s·ªë PL th·ª±c ƒë·∫°t">

    <div class="btn-group">
      <button id="submitBtn">T√≠nh To√°n</button>
      <button id="resetBtn">L√†m m·ªõi</button>
    </div>

    <div class="progress-container">
      <div id="progressBar" class="progress-bar">0%</div>
    </div>

    <p id="result"></p>
  </div>

  <script>
    // --- 1. C·∫§U H√åNH TH√îNG S·ªê (D·ªÑ D√ÄNG CH·ªàNH S·ª¨A T·∫†I ƒê√ÇY) ---
    const CONFIG = {
        "SO":  { ccTarget: 2, plTarget: 380, ccWeight: 0.2, plWeight: 0.8 },
        "SSO": { ccTarget: 3, plTarget: 520, ccWeight: 0.2, plWeight: 0.8 },
        "SE":  { ccTarget: 4, plTarget: 700, ccWeight: 0.2, plWeight: 0.8 }
    };

    document.getElementById("submitBtn").addEventListener("click", function () {
      const level = document.getElementById("level").value;
      let CC = document.getElementById("CC").value;
      let PL = document.getElementById("PL").value;
      
      const resultEl = document.getElementById("result");
      const progressBar = document.getElementById("progressBar");

      // Validate ƒë·∫ßu v√†o
      if (CC === '' || PL === '' || isNaN(CC) || isNaN(PL)) {
        resultEl.innerHTML = '‚ùå Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß s·ªë li·ªáu.';
        resultEl.style.color = "#ffcccc";
        updateProgress(0, "rgba(255,255,255,0.3)", "0%");
        return;
      }

      // Chuy·ªÉn sang s·ªë th·ª±c
      CC = parseFloat(CC);
      PL = parseFloat(PL);

      // L·∫•y c·∫•u h√¨nh d·ª±a tr√™n Level ƒë√£ ch·ªçn
      const setting = CONFIG[level];

      // --- T√çNH TO√ÅN ---
      // C√¥ng th·ª©c: (Th·ª±c ƒë·∫°t / Target) * Tr·ªçng s·ªë * 100
      const percentCC = (CC / setting.ccTarget) * setting.ccWeight * 100;
      const percentPL = (PL / setting.plTarget) * setting.plWeight * 100;
      
      const totalPercentage = percentCC + percentPL;
      
      // Hi·ªÉn th·ªã t·ªëi ƒëa 100% tr√™n thanh bar (d√π k·∫øt qu·∫£ c√≥ th·ªÉ > 100%)
      const displayBarPercent = Math.min(totalPercentage, 100);

      // Hi·ªÉn th·ªã k·∫øt qu·∫£ chi ti·∫øt
      resultEl.innerHTML = 
        `üîé <b>Level ${level}</b> (Target: CC ${setting.ccTarget} - PL ${setting.plTarget})<br>` +
        `‚Ä¢ CC (${setting.ccWeight*100}%): <strong>${percentCC.toFixed(2)}%</strong><br>` +
        `‚Ä¢ PL (${setting.plWeight*100}%): <strong>${percentPL.toFixed(2)}%</strong><br>` +
        `‚û°Ô∏è T·ªïng k·∫øt qu·∫£: <strong style="font-size:1.2em">${totalPercentage.toFixed(2)}%</strong>`;

      // ƒê·ªïi m√†u d·ª±a tr√™n k·∫øt qu·∫£
      let barColor;
      if (totalPercentage >= 100) {
        resultEl.style.color = "#b8ffb8"; // Xanh nh·∫°t
        barColor = "linear-gradient(90deg, #4caf50, #81c784)";
      } else {
        resultEl.style.color = "#fff8b3"; // V√†ng nh·∫°t
        barColor = "linear-gradient(90deg, #ffb347, #ffcc33)";
      }

      updateProgress(displayBarPercent, barColor, totalPercentage.toFixed(2) + "%");
    });

    // H√†m c·∫≠p nh·∫≠t thanh ti·∫øn tr√¨nh
    function updateProgress(width, color, text) {
        const bar = document.getElementById("progressBar");
        bar.style.width = width + "%";
        bar.style.background = color;
        bar.innerText = text;
    }

    // N√∫t Reset
    document.getElementById("resetBtn").addEventListener("click", function () {
      document.getElementById("level").value = "SO";
      document.getElementById("CC").value = "";
      document.getElementById("PL").value = "";
      document.getElementById("result").innerText = "";
      updateProgress(0, "rgba(255,255,255,0.3)", "0%");
    });
  </script>

</body>
</html>
